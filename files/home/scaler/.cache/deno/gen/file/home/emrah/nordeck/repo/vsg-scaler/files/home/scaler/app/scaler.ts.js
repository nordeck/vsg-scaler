import { serve } from "https://deno.land/std@0.211.0/http/server.ts";
import { STATUS_CODE } from "https://deno.land/std@0.211.0/http/status.ts";
import { DEBUG, HOSTNAME, JICOFO, PORT, PRE } from "./config.ts";
import { addHost, removeHost } from "./lifecycle.ts";
export let MIN_REQUIRED = 2;
export let MAX_ALLOWED = 80;
export let BULK_MAX = 5;
function notFound() {
  return new Response(null, {
    status: STATUS_CODE.NotFound
  });
}
function methodNotAllowed() {
  return new Response(null, {
    status: STATUS_CODE.MethodNotAllowed
  });
}
function badRequest() {
  return new Response(null, {
    status: STATUS_CODE.BadRequest
  });
}
function conflict() {
  return new Response(null, {
    status: STATUS_CODE.Conflict
  });
}
function succeeded() {
  return new Response(null, {
    status: STATUS_CODE.NoContent
  });
}
function ok(body) {
  return new Response(body, {
    status: STATUS_CODE.OK
  });
}
async function totalInstance() {
  try {
    const res = await fetch(JICOFO, {
      headers: {
        "Accept": "application/json"
      }
    });
    const stats = await res.json();
    return Number(stats.sip_jibri_detector.count);
  } catch  {
    return undefined;
  }
}
async function availableInstance() {
  try {
    const res = await fetch(JICOFO, {
      headers: {
        "Accept": "application/json"
      }
    });
    const stats = await res.json();
    return Number(stats.sip_jibri_detector.available);
  } catch  {
    return undefined;
  }
}
function remove(host) {
  removeHost(host);
  return ok("accepted");
}
async function removeHandler(req) {
  try {
    const pl = await req.json();
    const host = pl.host;
    const reason = pl.reason;
    if (DEBUG) {
      console.log(`remove request is received from ${host} for ${reason}`);
    }
    if (reason != "idle") return remove(host);
    const currentAvailable = await availableInstance();
    if (currentAvailable !== undefined && currentAvailable <= MIN_REQUIRED) {
      if (DEBUG) console.log(`minimum limit, rejected`);
      return ok("keep");
    }
    return remove(host);
  } catch  {
    if (DEBUG) console.log(`bad request`);
    return badRequest();
  }
}
function add(instanceType) {
  addHost(instanceType);
  return succeeded();
}
async function addHandler(req) {
  try {
    const pl = await req.json();
    const instanceType = pl.instance_type;
    if (DEBUG) console.log(`add request is received for ${instanceType}`);
    const currentTotal = await totalInstance();
    if (currentTotal === undefined) {
      if (DEBUG) console.log(`no jicofo, rejected`);
      return conflict();
    }
    if (currentTotal >= MAX_ALLOWED) {
      if (DEBUG) console.log(`no space for a new instance, rejected`);
      return conflict();
    }
    return add(instanceType);
  } catch  {
    if (DEBUG) console.log(`bad request`);
    return badRequest();
  }
}
async function updateMin(req) {
  try {
    const pl = await req.json();
    const min = parseInt(pl);
    if (DEBUG) console.log(`update request is received to set min as ${min}`);
    if (!min) throw new Error();
    if (min < 1 || min > 100) throw new Error();
    MIN_REQUIRED = min;
    if (DEBUG) console.log(`min is updated`);
    return succeeded();
  } catch  {
    if (DEBUG) console.log(`bad request`);
    return badRequest();
  }
}
async function updateMax(req) {
  try {
    const pl = await req.json();
    const max = parseInt(pl);
    if (DEBUG) console.log(`update request is received to set max as ${max}`);
    if (!max) throw new Error();
    if (max < 1 || max > 1000) throw new Error();
    MAX_ALLOWED = max;
    if (DEBUG) console.log(`max is updated`);
    return succeeded();
  } catch  {
    if (DEBUG) console.log(`bad request`);
    return badRequest();
  }
}
async function updateBulkMax(req) {
  try {
    const pl = await req.json();
    const max = parseInt(pl);
    if (DEBUG) {
      console.log(`update request is received to set bulk-max as ${max}`);
    }
    if (!max) throw new Error();
    if (max < 1 || max > 100) throw new Error();
    BULK_MAX = max;
    if (DEBUG) console.log(`bulk-max is updated`);
    return succeeded();
  } catch  {
    if (DEBUG) console.log(`bad request`);
    return badRequest();
  }
}
function getMin() {
  return ok(JSON.stringify(MIN_REQUIRED));
}
function getMax() {
  return ok(JSON.stringify(MAX_ALLOWED));
}
function getBulkMax() {
  return ok(JSON.stringify(BULK_MAX));
}
async function handler(req) {
  const url = new URL(req.url);
  const path = url.pathname;
  if (req.method === "POST") {
    if (path === `${PRE}/instance`) {
      return await addHandler(req);
    } else if (path === `${PRE}/min`) {
      return await updateMin(req);
    } else if (path === `${PRE}/max`) {
      return await updateMax(req);
    } else if (path === `${PRE}/bulk-max`) {
      return await updateBulkMax(req);
    } else {
      return notFound();
    }
  } else if (req.method === "DELETE") {
    if (path === `${PRE}/instance`) {
      return await removeHandler(req);
    } else {
      return notFound();
    }
  } else if (req.method === "GET") {
    if (path === `${PRE}/min`) {
      return getMin();
    } else if (path === `${PRE}/max`) {
      return getMax();
    } else if (path === `${PRE}/bulk-max`) {
      return getBulkMax();
    } else {
      return notFound();
    }
  } else if (req.method === "OPTIONS") {
    return succeeded();
  } else {
    return methodNotAllowed();
  }
}
function main() {
  serve(handler, {
    hostname: HOSTNAME,
    port: PORT
  });
}
main();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZpbGU6Ly8vaG9tZS9lbXJhaC9ub3JkZWNrL3JlcG8vdnNnLXNjYWxlci9maWxlcy9ob21lL3NjYWxlci9hcHAvc2NhbGVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBzY2FsZXIudHNcbi8vXG4vLyBUaGlzIHNlcnZpY2UgZ2V0cyBcInJlbW92ZSBtZVwiIGFuZCBcImFkZCBpbnN0YW5jZVwiIHJlcXVlc3RzIGZyb20gXCJzY2FsZS1kb3duXCJcbi8vIGFuZCBcInNjYWxlLXVwXCIgc2VydmljZXMgYW5kIHRyYW5zZmVycyB0aGVtIHRvIHRoZSBsaWZlY3ljbGUgbWFuYWdlbWVudCBBUEkgaWZcbi8vIGFsbCBjb25kaXRpb25zIGFyZSBPSy5cbi8vXG4vLyBVc2FnZTpcbi8vICAgICBkZW5vIHJ1biAtLWFsbG93LW5ldCBzY2FsZXIudHNcbi8vXG4vLyBUZXN0aW5nOlxuLy8gICAgIGN1cmwgaHR0cDovLzEyNy4wLjAuMTo5MDAwL3NjYWxlci9taW5cbi8vICAgICBjdXJsIGh0dHA6Ly8xMjcuMC4wLjE6OTAwMC9zY2FsZXIvbWF4XG4vLyAgICAgY3VybCBodHRwOi8vMTI3LjAuMC4xOjkwMDAvc2NhbGVyL2J1bGstbWF4XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuaW1wb3J0IHsgc2VydmUgfSBmcm9tIFwiaHR0cHM6Ly9kZW5vLmxhbmQvc3RkQDAuMjExLjAvaHR0cC9zZXJ2ZXIudHNcIjtcbmltcG9ydCB7IFNUQVRVU19DT0RFIH0gZnJvbSBcImh0dHBzOi8vZGVuby5sYW5kL3N0ZEAwLjIxMS4wL2h0dHAvc3RhdHVzLnRzXCI7XG5pbXBvcnQgeyBERUJVRywgSE9TVE5BTUUsIEpJQ09GTywgUE9SVCwgUFJFIH0gZnJvbSBcIi4vY29uZmlnLnRzXCI7XG5pbXBvcnQgeyBhZGRIb3N0LCByZW1vdmVIb3N0IH0gZnJvbSBcIi4vbGlmZWN5Y2xlLnRzXCI7XG5cbi8vIFRoZSBtaW5pbXVtIG51bWJlciBvZiBhdmFpbGFibGUgaW5zdGFuY2VzLiBTY2FsZXIgZG9lc24ndCBhY2NlcHQgYHJlbW92ZSBtZWBcbi8vIHJlcXVlc3QgaWYgdGhlIG51bWJlciBvZiBhdmFpbGFibGUgaW5zdGFuY2VzIGlzIGxlc3MgdGhhbiB0aGlzIHZhbHVlLlxuZXhwb3J0IGxldCBNSU5fUkVRVUlSRUQgPSAyO1xuXG4vLyBUaGUgbWF4aW11bSBudW1iZXIgb2YgdG90YWwgaW5zdGFuY2VzLiBTY2FsZXIgZG9lc24ndCBhY2NlcHQgYGFkZCBpbnN0YW5jZWBcbi8vIHJlcXVlc3QgaWYgdGhlIG51bWJlciBvZiB0b3RhbCBpbnN0YW5jZXMgaXMgbW9yZSB0aGFuIHRoaXMgdmFsdWUuXG5leHBvcnQgbGV0IE1BWF9BTExPV0VEID0gODA7XG5cbi8vIFRoZSBtYXhpbXVtIG51bWJlciBvZiByZXF1ZXN0cyBpbiBvbmUgYnVsayAoc3VjaCBhcyBhZGRIb3N0IHJlcXVlc3RzIGF0IGFcbi8vIHRpbWUpLiBTY2FsZXIgZG9lc24ndCBzZW5kIG1vcmUgcmVxdWVzdHMgdGhhbiB0aGlzIGxpbWl0IHRvIG5vdCBvdmVybG9hZCB0aGVcbi8vIGxpZmVjeWNsZSBtYW5hZ2VyLlxuZXhwb3J0IGxldCBCVUxLX01BWCA9IDU7XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBIVFRQIHJlc3BvbnNlIGZvciBOb3RGb3VuZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbmZ1bmN0aW9uIG5vdEZvdW5kKCk6IFJlc3BvbnNlIHtcbiAgcmV0dXJuIG5ldyBSZXNwb25zZShcbiAgICBudWxsLFxuICAgIHsgc3RhdHVzOiBTVEFUVVNfQ09ERS5Ob3RGb3VuZCB9LFxuICApO1xufVxuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gSFRUUCByZXNwb25zZSBmb3IgTWV0aG9kTm90QWxsb3dlZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbmZ1bmN0aW9uIG1ldGhvZE5vdEFsbG93ZWQoKTogUmVzcG9uc2Uge1xuICByZXR1cm4gbmV3IFJlc3BvbnNlKFxuICAgIG51bGwsXG4gICAgeyBzdGF0dXM6IFNUQVRVU19DT0RFLk1ldGhvZE5vdEFsbG93ZWQgfSxcbiAgKTtcbn1cblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIEhUVFAgcmVzcG9uc2UgZm9yIEJhZFJlcXVlc3Rcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5mdW5jdGlvbiBiYWRSZXF1ZXN0KCk6IFJlc3BvbnNlIHtcbiAgcmV0dXJuIG5ldyBSZXNwb25zZShcbiAgICBudWxsLFxuICAgIHsgc3RhdHVzOiBTVEFUVVNfQ09ERS5CYWRSZXF1ZXN0IH0sXG4gICk7XG59XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBIVFRQIHJlc3BvbnNlIGZvciBDb25mbGljdFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbmZ1bmN0aW9uIGNvbmZsaWN0KCk6IFJlc3BvbnNlIHtcbiAgcmV0dXJuIG5ldyBSZXNwb25zZShcbiAgICBudWxsLFxuICAgIHsgc3RhdHVzOiBTVEFUVVNfQ09ERS5Db25mbGljdCB9LFxuICApO1xufVxuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gSFRUUCByZXNwb25zZSBmb3IgU3VjY2VlZGVkIChOb0NvbnRlbnQsIE9LIHdpdGhvdXQgYSBib2R5KVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbmZ1bmN0aW9uIHN1Y2NlZWRlZCgpOiBSZXNwb25zZSB7XG4gIHJldHVybiBuZXcgUmVzcG9uc2UoXG4gICAgbnVsbCxcbiAgICB7IHN0YXR1czogU1RBVFVTX0NPREUuTm9Db250ZW50IH0sXG4gICk7XG59XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBIVFRQIHJlc3BvbnNlIGZvciBPSyAoT0sgd2l0aCBhIGJvZHkpXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuZnVuY3Rpb24gb2soYm9keTogc3RyaW5nKTogUmVzcG9uc2Uge1xuICByZXR1cm4gbmV3IFJlc3BvbnNlKFxuICAgIGJvZHksXG4gICAgeyBzdGF0dXM6IFNUQVRVU19DT0RFLk9LIH0sXG4gICk7XG59XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB0b3RhbEluc3RhbmNlLCBnZXQgdGhlIG51bWJlciBvZiB0b3RhbCBpbnN0YW5jZXMgZnJvbSBKaWNvZm9cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5hc3luYyBmdW5jdGlvbiB0b3RhbEluc3RhbmNlKCk6IFByb21pc2U8bnVtYmVyIHwgdW5kZWZpbmVkPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goSklDT0ZPLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIFwiQWNjZXB0XCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGNvbnN0IHN0YXRzID0gYXdhaXQgcmVzLmpzb24oKTtcblxuICAgIHJldHVybiBOdW1iZXIoc3RhdHMuc2lwX2ppYnJpX2RldGVjdG9yLmNvdW50KTtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxufVxuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gYXZhaWxhYmxlSW5zdGFuY2UsIGdldCB0aGUgbnVtYmVyIG9mIGF2YWlsYWJsZSBpbnN0YW5jZXMgZnJvbSBKaWNvZm9cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5hc3luYyBmdW5jdGlvbiBhdmFpbGFibGVJbnN0YW5jZSgpOiBQcm9taXNlPG51bWJlciB8IHVuZGVmaW5lZD4ge1xuICB0cnkge1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKEpJQ09GTywge1xuICAgICAgaGVhZGVyczoge1xuICAgICAgICBcIkFjY2VwdFwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICBjb25zdCBzdGF0cyA9IGF3YWl0IHJlcy5qc29uKCk7XG5cbiAgICByZXR1cm4gTnVtYmVyKHN0YXRzLnNpcF9qaWJyaV9kZXRlY3Rvci5hdmFpbGFibGUpO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG59XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyByZW1vdmVcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5mdW5jdGlvbiByZW1vdmUoaG9zdDogc3RyaW5nKTogUmVzcG9uc2Uge1xuICAvLyBkb250IHdhaXQgZm9yIHRoZSByZXN1bHQgb2YgdGhpcyBhc3luYyBmdW5jdGlvblxuICByZW1vdmVIb3N0KGhvc3QpO1xuXG4gIHJldHVybiBvayhcImFjY2VwdGVkXCIpO1xufVxuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gcmVtb3ZlSGFuZGxlclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbmFzeW5jIGZ1bmN0aW9uIHJlbW92ZUhhbmRsZXIocmVxOiBSZXF1ZXN0KTogUHJvbWlzZTxSZXNwb25zZT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHBsID0gYXdhaXQgcmVxLmpzb24oKTtcbiAgICBjb25zdCBob3N0ID0gcGwuaG9zdDtcbiAgICBjb25zdCByZWFzb24gPSBwbC5yZWFzb247XG5cbiAgICBpZiAoREVCVUcpIHtcbiAgICAgIGNvbnNvbGUubG9nKGByZW1vdmUgcmVxdWVzdCBpcyByZWNlaXZlZCBmcm9tICR7aG9zdH0gZm9yICR7cmVhc29ufWApO1xuICAgIH1cblxuICAgIC8vIGlmIHRoZSBpbnN0YW5jZSBpcyB1bmhlYWx0eSBvciBleHBpcmVkLCByZW1vdmUgaXQgaW1tZWRpYXRlbHkuXG4gICAgaWYgKHJlYXNvbiAhPSBcImlkbGVcIikgcmV0dXJuIHJlbW92ZShob3N0KTtcblxuICAgIC8vIGlmIHRoZSBudW1iZXIgb2YgYXZhaWxhYmxlIGluc3RhbmNlcyBpcyBsZXNzIHRoYW4gTUlOX1JFUVVJUkVEIHRoZW4gZG9uJ3RcbiAgICAvLyBhY2NlcHQgYHJlbW92ZSBtZWAgcmVxdWVzdHMuIHRoaXMgaXMgb25seSB2YWxpZCBmb3IgaWRsZSBpbnN0YW5jZXMuXG4gICAgY29uc3QgY3VycmVudEF2YWlsYWJsZSA9IGF3YWl0IGF2YWlsYWJsZUluc3RhbmNlKCk7XG4gICAgaWYgKGN1cnJlbnRBdmFpbGFibGUgIT09IHVuZGVmaW5lZCAmJiBjdXJyZW50QXZhaWxhYmxlIDw9IE1JTl9SRVFVSVJFRCkge1xuICAgICAgaWYgKERFQlVHKSBjb25zb2xlLmxvZyhgbWluaW11bSBsaW1pdCwgcmVqZWN0ZWRgKTtcbiAgICAgIHJldHVybiBvayhcImtlZXBcIik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlbW92ZShob3N0KTtcbiAgfSBjYXRjaCB7XG4gICAgaWYgKERFQlVHKSBjb25zb2xlLmxvZyhgYmFkIHJlcXVlc3RgKTtcbiAgICByZXR1cm4gYmFkUmVxdWVzdCgpO1xuICB9XG59XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBhZGRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5mdW5jdGlvbiBhZGQoaW5zdGFuY2VUeXBlOiBzdHJpbmcpOiBSZXNwb25zZSB7XG4gIC8vIGRvbnQgd2FpdCBmb3IgdGhlIHJlc3VsdCBvZiB0aGlzIGFzeW5jIGZ1bmN0aW9uXG4gIGFkZEhvc3QoaW5zdGFuY2VUeXBlKTtcblxuICByZXR1cm4gc3VjY2VlZGVkKCk7XG59XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBhZGRIYW5kbGVyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuYXN5bmMgZnVuY3Rpb24gYWRkSGFuZGxlcihyZXE6IFJlcXVlc3QpOiBQcm9taXNlPFJlc3BvbnNlPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcGwgPSBhd2FpdCByZXEuanNvbigpO1xuICAgIGNvbnN0IGluc3RhbmNlVHlwZSA9IHBsLmluc3RhbmNlX3R5cGU7XG5cbiAgICBpZiAoREVCVUcpIGNvbnNvbGUubG9nKGBhZGQgcmVxdWVzdCBpcyByZWNlaXZlZCBmb3IgJHtpbnN0YW5jZVR5cGV9YCk7XG5cbiAgICAvLyBpZiB0aGVyZSBpcyBubyByZXNwb25zZSBmcm9tIEppY29mbywgZG9uJ3QgYWNjZXB0IGBhZGQgaW5zdGFuY2VgIHJlcXVlc3RzXG4gICAgY29uc3QgY3VycmVudFRvdGFsID0gYXdhaXQgdG90YWxJbnN0YW5jZSgpO1xuICAgIGlmIChjdXJyZW50VG90YWwgPT09IHVuZGVmaW5lZCkge1xuICAgICAgaWYgKERFQlVHKSBjb25zb2xlLmxvZyhgbm8gamljb2ZvLCByZWplY3RlZGApO1xuICAgICAgcmV0dXJuIGNvbmZsaWN0KCk7XG4gICAgfVxuXG4gICAgLy8gaWYgdGhlIG51bWJlciBvZiB0b3RhbCBpbnN0YW5jZXMgaXMgbW9yZSB0aGFuIE1BWF9BTExPV0VEIHRoZW4gZG9uJ3RcbiAgICAvLyBhY2NlcHQgYGFkZCBpbnN0YW5jZWAgcmVxdWVzdHNcbiAgICBpZiAoY3VycmVudFRvdGFsID49IE1BWF9BTExPV0VEKSB7XG4gICAgICBpZiAoREVCVUcpIGNvbnNvbGUubG9nKGBubyBzcGFjZSBmb3IgYSBuZXcgaW5zdGFuY2UsIHJlamVjdGVkYCk7XG4gICAgICByZXR1cm4gY29uZmxpY3QoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gYWRkKGluc3RhbmNlVHlwZSk7XG4gIH0gY2F0Y2gge1xuICAgIGlmIChERUJVRykgY29uc29sZS5sb2coYGJhZCByZXF1ZXN0YCk7XG4gICAgcmV0dXJuIGJhZFJlcXVlc3QoKTtcbiAgfVxufVxuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gdXBkYXRlTWluXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuYXN5bmMgZnVuY3Rpb24gdXBkYXRlTWluKHJlcTogUmVxdWVzdCk6IFByb21pc2U8UmVzcG9uc2U+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBwbCA9IGF3YWl0IHJlcS5qc29uKCk7XG4gICAgY29uc3QgbWluID0gcGFyc2VJbnQocGwpO1xuXG4gICAgaWYgKERFQlVHKSBjb25zb2xlLmxvZyhgdXBkYXRlIHJlcXVlc3QgaXMgcmVjZWl2ZWQgdG8gc2V0IG1pbiBhcyAke21pbn1gKTtcblxuICAgIGlmICghbWluKSB0aHJvdyBuZXcgRXJyb3IoKTtcbiAgICBpZiAobWluIDwgMSB8fCBtaW4gPiAxMDApIHRocm93IG5ldyBFcnJvcigpO1xuXG4gICAgTUlOX1JFUVVJUkVEID0gbWluO1xuICAgIGlmIChERUJVRykgY29uc29sZS5sb2coYG1pbiBpcyB1cGRhdGVkYCk7XG5cbiAgICByZXR1cm4gc3VjY2VlZGVkKCk7XG4gIH0gY2F0Y2gge1xuICAgIGlmIChERUJVRykgY29uc29sZS5sb2coYGJhZCByZXF1ZXN0YCk7XG4gICAgcmV0dXJuIGJhZFJlcXVlc3QoKTtcbiAgfVxufVxuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gdXBkYXRlTWF4XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuYXN5bmMgZnVuY3Rpb24gdXBkYXRlTWF4KHJlcTogUmVxdWVzdCk6IFByb21pc2U8UmVzcG9uc2U+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBwbCA9IGF3YWl0IHJlcS5qc29uKCk7XG4gICAgY29uc3QgbWF4ID0gcGFyc2VJbnQocGwpO1xuXG4gICAgaWYgKERFQlVHKSBjb25zb2xlLmxvZyhgdXBkYXRlIHJlcXVlc3QgaXMgcmVjZWl2ZWQgdG8gc2V0IG1heCBhcyAke21heH1gKTtcblxuICAgIGlmICghbWF4KSB0aHJvdyBuZXcgRXJyb3IoKTtcbiAgICBpZiAobWF4IDwgMSB8fCBtYXggPiAxMDAwKSB0aHJvdyBuZXcgRXJyb3IoKTtcblxuICAgIE1BWF9BTExPV0VEID0gbWF4O1xuICAgIGlmIChERUJVRykgY29uc29sZS5sb2coYG1heCBpcyB1cGRhdGVkYCk7XG5cbiAgICByZXR1cm4gc3VjY2VlZGVkKCk7XG4gIH0gY2F0Y2gge1xuICAgIGlmIChERUJVRykgY29uc29sZS5sb2coYGJhZCByZXF1ZXN0YCk7XG4gICAgcmV0dXJuIGJhZFJlcXVlc3QoKTtcbiAgfVxufVxuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gdXBkYXRlQnVsa01heFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbmFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUJ1bGtNYXgocmVxOiBSZXF1ZXN0KTogUHJvbWlzZTxSZXNwb25zZT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHBsID0gYXdhaXQgcmVxLmpzb24oKTtcbiAgICBjb25zdCBtYXggPSBwYXJzZUludChwbCk7XG5cbiAgICBpZiAoREVCVUcpIHtcbiAgICAgIGNvbnNvbGUubG9nKGB1cGRhdGUgcmVxdWVzdCBpcyByZWNlaXZlZCB0byBzZXQgYnVsay1tYXggYXMgJHttYXh9YCk7XG4gICAgfVxuXG4gICAgaWYgKCFtYXgpIHRocm93IG5ldyBFcnJvcigpO1xuICAgIGlmIChtYXggPCAxIHx8IG1heCA+IDEwMCkgdGhyb3cgbmV3IEVycm9yKCk7XG5cbiAgICBCVUxLX01BWCA9IG1heDtcbiAgICBpZiAoREVCVUcpIGNvbnNvbGUubG9nKGBidWxrLW1heCBpcyB1cGRhdGVkYCk7XG5cbiAgICByZXR1cm4gc3VjY2VlZGVkKCk7XG4gIH0gY2F0Y2gge1xuICAgIGlmIChERUJVRykgY29uc29sZS5sb2coYGJhZCByZXF1ZXN0YCk7XG4gICAgcmV0dXJuIGJhZFJlcXVlc3QoKTtcbiAgfVxufVxuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZ2V0TWluXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuZnVuY3Rpb24gZ2V0TWluKCk6IFJlc3BvbnNlIHtcbiAgcmV0dXJuIG9rKEpTT04uc3RyaW5naWZ5KE1JTl9SRVFVSVJFRCkpO1xufVxuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZ2V0TWF4XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuZnVuY3Rpb24gZ2V0TWF4KCk6IFJlc3BvbnNlIHtcbiAgcmV0dXJuIG9rKEpTT04uc3RyaW5naWZ5KE1BWF9BTExPV0VEKSk7XG59XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBnZXRCdWxrTWF4XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuZnVuY3Rpb24gZ2V0QnVsa01heCgpOiBSZXNwb25zZSB7XG4gIHJldHVybiBvayhKU09OLnN0cmluZ2lmeShCVUxLX01BWCkpO1xufVxuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gaGFuZGxlclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxOiBSZXF1ZXN0KTogUHJvbWlzZTxSZXNwb25zZT4ge1xuICBjb25zdCB1cmwgPSBuZXcgVVJMKHJlcS51cmwpO1xuICBjb25zdCBwYXRoID0gdXJsLnBhdGhuYW1lO1xuXG4gIGlmIChyZXEubWV0aG9kID09PSBcIlBPU1RcIikge1xuICAgIGlmIChwYXRoID09PSBgJHtQUkV9L2luc3RhbmNlYCkge1xuICAgICAgcmV0dXJuIGF3YWl0IGFkZEhhbmRsZXIocmVxKTtcbiAgICB9IGVsc2UgaWYgKHBhdGggPT09IGAke1BSRX0vbWluYCkge1xuICAgICAgcmV0dXJuIGF3YWl0IHVwZGF0ZU1pbihyZXEpO1xuICAgIH0gZWxzZSBpZiAocGF0aCA9PT0gYCR7UFJFfS9tYXhgKSB7XG4gICAgICByZXR1cm4gYXdhaXQgdXBkYXRlTWF4KHJlcSk7XG4gICAgfSBlbHNlIGlmIChwYXRoID09PSBgJHtQUkV9L2J1bGstbWF4YCkge1xuICAgICAgcmV0dXJuIGF3YWl0IHVwZGF0ZUJ1bGtNYXgocmVxKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG5vdEZvdW5kKCk7XG4gICAgfVxuICB9IGVsc2UgaWYgKHJlcS5tZXRob2QgPT09IFwiREVMRVRFXCIpIHtcbiAgICBpZiAocGF0aCA9PT0gYCR7UFJFfS9pbnN0YW5jZWApIHtcbiAgICAgIHJldHVybiBhd2FpdCByZW1vdmVIYW5kbGVyKHJlcSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBub3RGb3VuZCgpO1xuICAgIH1cbiAgfSBlbHNlIGlmIChyZXEubWV0aG9kID09PSBcIkdFVFwiKSB7XG4gICAgaWYgKHBhdGggPT09IGAke1BSRX0vbWluYCkge1xuICAgICAgcmV0dXJuIGdldE1pbigpO1xuICAgIH0gZWxzZSBpZiAocGF0aCA9PT0gYCR7UFJFfS9tYXhgKSB7XG4gICAgICByZXR1cm4gZ2V0TWF4KCk7XG4gICAgfSBlbHNlIGlmIChwYXRoID09PSBgJHtQUkV9L2J1bGstbWF4YCkge1xuICAgICAgcmV0dXJuIGdldEJ1bGtNYXgoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG5vdEZvdW5kKCk7XG4gICAgfVxuICB9IGVsc2UgaWYgKHJlcS5tZXRob2QgPT09IFwiT1BUSU9OU1wiKSB7XG4gICAgcmV0dXJuIHN1Y2NlZWRlZCgpO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBtZXRob2ROb3RBbGxvd2VkKCk7XG4gIH1cbn1cblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIG1haW5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5mdW5jdGlvbiBtYWluKCkge1xuICBzZXJ2ZShoYW5kbGVyLCB7XG4gICAgaG9zdG5hbWU6IEhPU1ROQU1FLFxuICAgIHBvcnQ6IFBPUlQsXG4gIH0pO1xufVxuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxubWFpbigpO1xuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQWVBLFNBQVMsS0FBSyxRQUFRLCtDQUErQztBQUNyRSxTQUFTLFdBQVcsUUFBUSwrQ0FBK0M7QUFDM0UsU0FBUyxLQUFLLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsR0FBRyxRQUFRLGNBQWM7QUFDakUsU0FBUyxPQUFPLEVBQUUsVUFBVSxRQUFRLGlCQUFpQjtBQUlyRCxPQUFPLElBQUksZUFBZSxFQUFFO0FBSTVCLE9BQU8sSUFBSSxjQUFjLEdBQUc7QUFLNUIsT0FBTyxJQUFJLFdBQVcsRUFBRTtBQUt4QixTQUFTO0VBQ1AsT0FBTyxJQUFJLFNBQ1QsTUFDQTtJQUFFLFFBQVEsWUFBWSxRQUFRO0VBQUM7QUFFbkM7QUFLQSxTQUFTO0VBQ1AsT0FBTyxJQUFJLFNBQ1QsTUFDQTtJQUFFLFFBQVEsWUFBWSxnQkFBZ0I7RUFBQztBQUUzQztBQUtBLFNBQVM7RUFDUCxPQUFPLElBQUksU0FDVCxNQUNBO0lBQUUsUUFBUSxZQUFZLFVBQVU7RUFBQztBQUVyQztBQUtBLFNBQVM7RUFDUCxPQUFPLElBQUksU0FDVCxNQUNBO0lBQUUsUUFBUSxZQUFZLFFBQVE7RUFBQztBQUVuQztBQUtBLFNBQVM7RUFDUCxPQUFPLElBQUksU0FDVCxNQUNBO0lBQUUsUUFBUSxZQUFZLFNBQVM7RUFBQztBQUVwQztBQUtBLFNBQVMsR0FBRyxJQUFZO0VBQ3RCLE9BQU8sSUFBSSxTQUNULE1BQ0E7SUFBRSxRQUFRLFlBQVksRUFBRTtFQUFDO0FBRTdCO0FBS0EsZUFBZTtFQUNiLElB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